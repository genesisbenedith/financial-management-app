<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>User.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">csc335-final-project</a> &gt; <a href="index.source.html" class="el_package">csc335.app.models</a> &gt; <span class="el_source">User.java</span></div><h1>User.java</h1><pre class="source lang-java linenums">package csc335.app.models;

import java.io.File;
import java.time.LocalDate;

/**
 * Author(s): Genesis Benedith
 * File: User.java
 * Description: Model class that represents a user account
 */

import java.util.*;

public class User {
    private String username;
    private String email;
    private String password;
    private Map&lt;Category, List&lt;Expense&gt;&gt; categorizedExpenses; // Maps categories to a list of expenses
    private Map&lt;Category, Budget&gt; categorizedBudgets; // Maps categories to budgets
    private List&lt;Report&gt; monthlyReports; 

    /* ------------------------------ Constructor ------------------------------ */

<span class="nc" id="L24">    public User(String username, String email, String password) {</span>
<span class="nc" id="L25">        this.username = username;</span>
<span class="nc" id="L26">        this.email = email;</span>
<span class="nc" id="L27">        this.password = password;</span>
<span class="nc" id="L28">        this.categorizedExpenses = new HashMap&lt;&gt;();</span>
<span class="nc" id="L29">        this.categorizedBudgets = new HashMap&lt;&gt;();</span>
<span class="nc" id="L30">        this.monthlyReports = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L31">    }</span>

    /* ------------------------------ Getters ------------------------------ */

    public String getUsername() {
<span class="nc" id="L36">        return username;</span>
    }

    public String getPassword() {
<span class="nc" id="L40">        return password;</span>
    }

    public String getEmail() {
<span class="nc" id="L44">        return email;</span>
    }

    public List&lt;Expense&gt; getAllExpenses() {
<span class="nc" id="L48">        List&lt;Expense&gt; allExpenses = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L49" title="All 2 branches missed.">        for (Map.Entry&lt;Category, List&lt;Expense&gt;&gt; expenseCategory : categorizedExpenses.entrySet()) {</span>
<span class="nc" id="L50">            allExpenses.addAll(expenseCategory.getValue());</span>
<span class="nc" id="L51">        }</span>
<span class="nc" id="L52">        return Collections.unmodifiableList(allExpenses);</span>
    }

    public List&lt;Budget&gt; getAllBudgets() {
<span class="nc" id="L56">        List&lt;Budget&gt; allBudgets = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L57" title="All 2 branches missed.">        for (Map.Entry&lt;Category, Budget&gt; budgetCategory : categorizedBudgets.entrySet()) {</span>
<span class="nc" id="L58">            allBudgets.add(budgetCategory.getValue());</span>
<span class="nc" id="L59">        }</span>
<span class="nc" id="L60">        return Collections.unmodifiableList(allBudgets);</span>
    }

    // public File getMonthlyReport(LocalDate reportDate) {
    //     for (Expense expense : monthlyReports) {
    //         if (report.getReportDate().equals(reportDate)) {
    //             report.update;
    //             return new File(report.getMonthlyReportPath());
    //         }
    //     }
    //     return null;
    // }

    public double getTotalExpenses() {
<span class="nc" id="L74">        double totalExpenses = 0;</span>
<span class="nc bnc" id="L75" title="All 2 branches missed.">        for (Expense expense : getAllExpenses()) {</span>
<span class="nc" id="L76">            totalExpenses += expense.getAmount();</span>
<span class="nc" id="L77">        }</span>
<span class="nc" id="L78">        return totalExpenses;</span>
    }

    public List&lt;Expense&gt; getCategoryExpenses(Category expenseCategory) {
<span class="nc" id="L82">        List&lt;Expense&gt; categoryExpenses = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L83" title="All 2 branches missed.">        if (categorizedExpenses.containsKey(expenseCategory)) {</span>
<span class="nc" id="L84">            categoryExpenses.addAll(categorizedExpenses.get(expenseCategory));</span>
        }
<span class="nc" id="L86">        return Collections.unmodifiableList(categoryExpenses);</span>
    }

    public Map&lt;Category, Budget&gt; getCategorizedBudgets() {
<span class="nc" id="L90">        return Collections.unmodifiableMap(categorizedBudgets);</span>
    }

    public Map&lt;Category, List&lt;Expense&gt;&gt; getCategorizedExpenses() {
<span class="nc" id="L94">        return Collections.unmodifiableMap(categorizedExpenses);</span>
    }

    /* ------------------------------ Setters ------------------------------ */

    public void setEmail(String email) {
<span class="nc" id="L100">        this.email = email;</span>
<span class="nc" id="L101">    }</span>

    public void setUsername(String username) {
<span class="nc" id="L104">        this.username = username;</span>
<span class="nc" id="L105">    }</span>

    public void setPassword(String password) {
<span class="nc" id="L108">        this.password = password;</span>
<span class="nc" id="L109">    }</span>

    public void setBudget(Category category, double limit) {
<span class="nc bnc" id="L112" title="All 2 branches missed.">        if (limit &lt; 0) {</span>
<span class="nc" id="L113">            throw new IllegalArgumentException(&quot;Budget amount cannot be negative.&quot;);</span>
        }

<span class="nc bnc" id="L116" title="All 2 branches missed.">        if (categorizedBudgets.containsKey(category)) {</span>
            // Update the budget for the category if it already exists in map
<span class="nc" id="L118">            this.categorizedBudgets.get(category).setLimit(limit);</span>
        } else {
            // Create a new budget for the category if it doesn't exist in map
<span class="nc" id="L121">            this.categorizedBudgets.put(category, new Budget(category, limit));</span>
        }
<span class="nc" id="L123">    }</span>

    /*
     * ------------------------------ Other Methods ------------------------------
     */

    public void addExpense(Expense newExpense) {
        // Check if expense category is already a key in map
<span class="nc bnc" id="L131" title="All 2 branches missed.">        if (this.categorizedExpenses.containsKey(newExpense.getCategory())) {</span>
            // Add expense to the category's list of expenses
<span class="nc" id="L133">            this.categorizedExpenses.get(newExpense.getCategory()).add(newExpense);</span>
        } else {
            // Create a new list of expenses for category and add to map
<span class="nc" id="L136">            List&lt;Expense&gt; categoryExpenses = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L137">            categoryExpenses.add(newExpense);</span>
<span class="nc" id="L138">            this.categorizedExpenses.put(newExpense.getCategory(), categoryExpenses);</span>
        }

        // Update all budgets
<span class="nc" id="L142">        updateUserBudgets();</span>
<span class="nc" id="L143">    }</span>

    public void removeExpense(Expense expense) {
        // Remove the expense from its category list
<span class="nc" id="L147">        this.categorizedExpenses.get(expense.getCategory()).remove(expense);</span>

        // Update the budget for the category after removing the expense
<span class="nc" id="L150">        updateUserBudgets();</span>
<span class="nc" id="L151">    }</span>

    public void updateUserBudgets() {
        // Update each budget with the most recent saved expenses
<span class="nc bnc" id="L155" title="All 2 branches missed.">        for (Map.Entry&lt;Category, Budget&gt; categorizedBudget : this.categorizedBudgets.entrySet()) {</span>
<span class="nc" id="L156">            categorizedBudget.getValue().addExpenses(getCategoryExpenses(categorizedBudget.getKey()));</span>
<span class="nc" id="L157">        }</span>
        
<span class="nc" id="L159">    }</span>

    public void removeBudget(Category budgetCategory) {
<span class="nc bnc" id="L162" title="All 2 branches missed.">        if (this.categorizedBudgets.containsKey(budgetCategory)) {</span>
<span class="nc" id="L163">            this.categorizedBudgets.get(budgetCategory).setLimit(0);</span>
        }
<span class="nc" id="L165">    }</span>

    @Override
    public String toString() {
<span class="nc" id="L169">        StringBuilder sb = new StringBuilder();</span>
<span class="nc" id="L170">        sb.append(&quot;User Information:\n&quot;);</span>
<span class="nc" id="L171">        sb.append(&quot;Username: &quot;).append(username).append(&quot;\n&quot;);</span>
<span class="nc" id="L172">        sb.append(&quot;Email: &quot;).append(email).append(&quot;\n&quot;);</span>
<span class="nc" id="L173">        sb.append(&quot;Total Expenses: $&quot;).append(String.format(&quot;%.2f&quot;, getTotalExpenses())).append(&quot;\n&quot;);</span>

<span class="nc" id="L175">        sb.append(&quot;\nBudgets:\n&quot;);</span>
<span class="nc bnc" id="L176" title="All 2 branches missed.">        if (this.categorizedBudgets.isEmpty()) {</span>
<span class="nc" id="L177">            sb.append(&quot;No budgets set.\n&quot;);</span>
        } else {
<span class="nc bnc" id="L179" title="All 2 branches missed.">            for (Map.Entry&lt;Category, Budget&gt; entry : this.categorizedBudgets.entrySet()) {</span>
<span class="nc" id="L180">                sb.append(&quot;  &quot;).append(entry.getKey()).append(&quot;: &quot;)</span>
<span class="nc" id="L181">                        .append(entry.getValue().getTotalSpent()).append(&quot;/&quot;)</span>
<span class="nc" id="L182">                        .append(entry.getValue().getLimit()).append(&quot;\n&quot;);</span>
<span class="nc" id="L183">            }</span>
        }

<span class="nc" id="L186">        sb.append(&quot;\nExpenses:\n&quot;);</span>
<span class="nc bnc" id="L187" title="All 2 branches missed.">        if (getAllExpenses().isEmpty()) {</span>
<span class="nc" id="L188">            sb.append(&quot;No expenses recorded.\n&quot;);</span>
        } else {
<span class="nc bnc" id="L190" title="All 2 branches missed.">            for (Expense expense : getAllExpenses()) {</span>
<span class="nc" id="L191">                sb.append(&quot;  &quot;).append(expense).append(&quot;\n&quot;);</span>
<span class="nc" id="L192">            }</span>
        }

<span class="nc" id="L195">        return sb.toString();</span>
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.4.201905082037</span></div></body></html>